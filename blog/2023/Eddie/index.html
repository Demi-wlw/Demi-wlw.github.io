<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="2AXgTeXWVW_0injIR91zWl2Dz2AJyUT9xr667wSGOcY"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>How to use Eddie: the ECDF Linux Compute Cluster | Luwei Wang (Demi)</title> <meta name="author" content="Luwei Wang (Demi)"> <meta name="description" content="It is a High-performance computing cluster of the University of Edinburgh"> <meta name="keywords" content="academic-website, personal-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/tiger.png"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://demi-wlw.github.io/blog/2023/Eddie/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Luwei </span>Wang (Demi)</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Home</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">How to use Eddie: the ECDF Linux Compute Cluster</h1> <p class="post-meta">September 25, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/code"> <i class="fas fa-hashtag fa-sm"></i> code</a>     ·   <a href="/blog/category/site-posts"> <i class="fas fa-tag fa-sm"></i> site-posts</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>More about Eddie please see <a href="https://www.ed.ac.uk/information-services/research-support/research-computing/ecdf/high-performance-computing" rel="external nofollow noopener" target="_blank">here</a>.</p> <h2 id="login"><strong>Login</strong></h2> <p>Open the terminal and input:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh &lt;YOUR UUN&gt;@eddie.ecdf.ed.ac.uk
</code></pre></div></div> <p>to login to the home directory.</p> <blockquote class="block-warning"> <h5 id="warning">WARNING</h5> <p>As mentioned by the IT staff, Eddie of UoE does not support the <code class="language-plaintext highlighter-rouge">Remote-ssh</code> login in VScode extension due to security issues. But it is fine to use the <code class="language-plaintext highlighter-rouge">scp</code> or <code class="language-plaintext highlighter-rouge">sftp</code> extension to only manage the file system.</p> </blockquote> <h2 id="folder-path"><strong>Folder Path</strong></h2> <p>This is the shared group space in UoE. <br> <strong>Eddie</strong>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/exports/&lt;COLLEGE&gt;/eddie/&lt;SCHOOL&gt;/groups/&lt;GROUP NAME&gt;/
</code></pre></div></div> <p><strong>DataStore</strong>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/exports/&lt;COLLEGE&gt;/datastore/&lt;SCHOOL&gt;/groups/&lt;GROUP NAME&gt;/
</code></pre></div></div> <blockquote class="block-tip"> <h5 id="tip">TIP</h5> <p>All-caps words in <code class="language-plaintext highlighter-rouge">&lt; &gt;</code> should be replaced with your own choices. DataStore is a network file storage service.</p> </blockquote> <h2 id="basic-commands-on-eddie"><strong>Basic Commands on Eddie</strong></h2> <p>To start an interactive session run:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qlogin 
<span class="c"># The default maximum runtime is 48 hours. The default resources: 1 core, 1 GB memory.</span>

qlogin <span class="nt">-l</span> <span class="nv">h_vmem</span><span class="o">=</span>1G 
<span class="c"># request memory for an interactive session</span>

qlogin <span class="nt">-pe</span> gpu 1 
<span class="c"># request 1 gpu (need for torch and memory usage is at least 2GB)</span>

qlogin <span class="nt">-q</span> staging 
<span class="c"># choose the staging environment</span>
</code></pre></div></div> <p>Staging data (transfer data between Eddie and DataStore):</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qsub stagein/out.sh 
<span class="c"># stagein/out.sh file content can be seen in Eddie handbook (need UUN login)</span>
</code></pre></div></div> <blockquote class="block-tip"> <h5 id="tip-1">TIP</h5> <p>It is also possible to sync the files between local computer and Eddie directly using <code class="language-plaintext highlighter-rouge">scp</code> or <code class="language-plaintext highlighter-rouge">sftp</code>.</p> </blockquote> <p>To view current running jobs</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qstat
</code></pre></div></div> <p>To cancel a job,</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qdel &lt;JOB IDENTIFIER&gt;
</code></pre></div></div> <p>Detailed information about completed jobs is available with the qacct command:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qacct <span class="nt">-j</span> &lt;JOB IDENTIFIER&gt;
</code></pre></div></div> <h2 id="set-up-the-anaconda-environment"><strong>Set up the Anaconda Environment</strong></h2> <h3 id="add-path-and-create-a-virtual-environment">Add path and create a virtual environment</h3> <p>Configure the path for your environments directory, i.e., the directory where all your conda environments will be stored, and packages (pkgs) directory used as a cache for your conda packages. By default cache for packages will be placed under <code class="language-plaintext highlighter-rouge">~/.conda/pkgs</code> and will very likely cause your home directory to go over quota as a result. We recommend using the group space you have used for your conda environments instead. <strong>Note that this should be an existing directory, so you need to create it first if it doesn’t already exist, before running the command below.</strong></p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>module load anaconda <span class="c"># version 5.0.1</span>
</code></pre></div></div> <p>Skip this step if already created the virtual environment</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda config <span class="nt">--add</span> envs_dirs /exports/&lt;COLLEGE&gt;/eddie/&lt;SCHOOL&gt;/groups/&lt;GROUP NAME&gt;/anaconda/envs

conda config <span class="nt">--add</span> pkgs_dirs /exports/&lt;COLLEGE&gt;/eddie/&lt;SCHOOL&gt;/groups/&lt;GROUP NAME&gt;/anaconda/pkgs
</code></pre></div></div> <p>Once you have configured your <code class="language-plaintext highlighter-rouge">envs_dirs</code> and <code class="language-plaintext highlighter-rouge">pkgs_dirs</code>, you can create an environment. The example below creates an environment specifying particular Python versions (also the version used for this project):</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda create <span class="nt">-n</span> %env_name% <span class="nv">python</span><span class="o">=</span>3.9
</code></pre></div></div> <p>To list your conda environments:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda info <span class="nt">--envs</span>
</code></pre></div></div> <h3 id="activate-your-environment">Activate your environment</h3> <p>Switch to the created environment and deactivate the environment when no longer needed:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source </span>activate %env_name%
<span class="nb">source </span>deactivate
</code></pre></div></div> <h3 id="install-required-packages">Install required packages</h3> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda <span class="nb">install </span>pip
pip <span class="nt">--no-cache-dir</span> <span class="nb">install</span> <span class="nt">-r</span> requirements.txt 
<span class="c"># `--no-cache-dir` is to ensure torch installed successfully</span>
</code></pre></div></div> <p><strong>Some package management commands:</strong></p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda list 
<span class="c"># To see what packages are in the active environment</span>
conda search matplotlib 
<span class="c"># To search for a package in the Anaconda repositories</span>
conda <span class="nb">install </span><span class="nv">matplotlib</span><span class="o">=</span>1.4.1 
<span class="c"># To install a package e.g. matplotlib version 1.4.1</span>
</code></pre></div></div> <h4 id="using-pip">Using pip</h4> <p>If a package is not available in the Anaconda repositories it can still be installed with <code class="language-plaintext highlighter-rouge">pip</code> in the usual way. First install <code class="language-plaintext highlighter-rouge">pip</code> into your active Anaconda environment. You must install pip into your environment first before running a pip command. Otherwise, <code class="language-plaintext highlighter-rouge">pip install</code> will use the pip installed in the Anaconda directory (which users do not have write access to) and your installation will fail. Once you have installed pip in your environment, then you can install a package using pip into your environment:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda <span class="nb">install </span>pip
pip <span class="nb">install </span>matplotlib
</code></pre></div></div> <h2 id="set-up-r-environment"><strong>Set up R Environment</strong></h2> <h3 id="configure-r-packages-path">Configure R packages path</h3> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>module load cmake/3.5.2
<span class="c"># some packages may need this to be loaded first</span>
module load igmm/apps/R/4.1.3
<span class="nb">export </span><span class="nv">R_LIBS</span><span class="o">=</span>/exports/&lt;COLLEGE&gt;/eddie/&lt;SCHOOL&gt;/groups/&lt;GROUP NAME&gt;/rlibs
</code></pre></div></div> <p><strong>Install required packages in R</strong></p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s2">"tidyverse"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h2 id="run-code-on-eddie"><strong>Run Code on Eddie</strong></h2> <h3 id="through-job-submission">Through job submission</h3> <p><strong>Example</strong></p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qsub run_job.sh 
<span class="c"># job submission files are available in shell folder</span>
</code></pre></div></div> <h3 id="through-interaction-session">Through interaction session</h3> <p>First start an interaction session, specify max run time, memory usage (gpu) and activate the environment then run according to the following: <strong>Run Jupyter notebook</strong></p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jupyter nbconvert <span class="nt">--to</span> notebook <span class="nt">--inplace</span> <span class="nt">--execute</span> jupyter-notebook.ipynb
</code></pre></div></div> <p>Note that <code class="language-plaintext highlighter-rouge">nbconvert</code> will fail if any cell takes longer than 30s to run, then add the following option to disable timing</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--ExecutePreprocessor.timeout=-1
</code></pre></div></div> <p>View jupyter notebook ouptputs</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nbpreview jupyter-notebook.ipynb
</code></pre></div></div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/Conda-R4vscode/">**Installing R in Conda Env and Easy Use with VScode**</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/Conda_cheetsheet/">Summary of Conda commands</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/ChatGPT/">Understanding ChatGPT</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/Latex-symbols/">Summary of Latex code for symbols</a> </li> <div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"Demi-wlw/Demi-wlw.github.io","data-repo-id":"R_kgDOIh5mVw","data-category":"Comments","data-category-id":"DIC_kwDOIh5mV84CUz5b","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Luwei Wang (Demi). Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: January 28, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>